<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Despertar Del ⛧ Averno</title>
  <link rel="shortcut icon" href="https://static.thenounproject.com/png/26242-200.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"/>
  <style>
    /* Estilos existentes... */
    .error-msg {
      color: red;
      font-size: 13px;
      display: block;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <!-- Contenedores de catálogo -->
  <div id="catalogo-ropa"></div>
  <div id="catalogo-accesorios"></div>

  <!-- Scripts -->
  <script>
    const productosRopa = [
      { nombre: "VESTIDO", precio: 40000, imagen: "https://i.pinimg.com/736x/2a/11/93/2a119370d306d8ae644a1476733fd79a.jpg" },
      { nombre: "VESTIDO", precio: 85000, imagen: "https://m.media-amazon.com/images/I/61d6aZLQlGS._AC_UY1000_.jpg" },
      { nombre: "VESTIDO", precio: 20000, imagen: "https://i5.walmartimages.com/asr/f58a2714-cae4-446d-b67d-6ad1939e068e.deed06704ee19460c2c043153999414b.jpeg?odnHeight=612&odnWidth=612&odnBg=FFFFFF" }
    ];
    const productosAccesorios = [
      { nombre: "GORRA", precio: 15000, imagen: "https://example.com/gorra.jpg" },
      { nombre: "PULSERA", precio: 8000, imagen: "https://example.com/pulsera.jpg" }
    ];

    let wishlistData = {};
    let cartData = {};

    function crearItem(producto, esRopa = true, idx) {
      const item = document.createElement("div");
      item.className = "item";
      const baseId = producto.nombre.replace(/\s+/g, "_");
      const id = `${baseId}_${idx}`;
      let tallaSelect = esRopa ? `
        <label class="cantidad-label">Talla:
          <select class="cantidad-input" id="talla-${id}">
            <option value="">Elige talla</option>
            <option value="S">S</option>
            <option value="M">M</option>
            <option value="L">L</option>
            <option value="XL">XL</option>
          </select>
        </label>
        <span id="error-${id}" class="error-msg"></span>
      ` : "";

      item.innerHTML = `
        <span class="heart-icon" onclick="toggleFavorite(this,'${producto.nombre}',${producto.precio},${esRopa})">⛧</span>
        <img src="${producto.imagen}" alt="${producto.nombre}">
        <h3>${producto.nombre}</h3>
        <div class="precio">$${producto.precio.toLocaleString()}</div>
        <label class="cantidad-label">Cantidad:
          <input type="number" min="1" value="1" class="cantidad-input" id="cantidad-${id}">
        </label>
        ${tallaSelect}
        <button class="cart-button" onclick="addToCart('${producto.nombre}',${producto.precio},${esRopa},'${id}')">Agregar al carrito</button>
      `;

      if (esRopa) {
        const select = item.querySelector(`#talla-${id}`);
        const errorSpan = item.querySelector(`#error-${id}`);
        select.addEventListener('change', () => {
          if (select.value) errorSpan.textContent = '';
        });
      }

      return item;
    }

    function renderCatalogo(productos, contenedorId, esRopa) {
      const cont = document.getElementById(contenedorId);
      cont.innerHTML = '';
      productos.forEach((p, i) => cont.appendChild(crearItem(p, esRopa, i)));
    }

    function addToCart(nombre, precio, esRopa, id) {
      const cantidad = parseInt(document.getElementById(`cantidad-${id}`).value || '1');
      let talla = '';
      if (esRopa) {
        talla = document.getElementById(`talla-${id}`).value;
        const errorEl = document.getElementById(`error-${id}`);
        if (!talla) {
          errorEl.textContent = 'POR FAVOR SELECCIONA ⛧ UNA TALLA.';
          return;
        } else {
          errorEl.textContent = '';
        }
      }
      cartData[`${nombre}_${id}`] = { precio, cantidad, talla };
      renderCarrito();
    }

    // Funciones toggleFavorite, renderWishlist, renderCarrito, etc.
    function toggleFavorite(el, nombre, precio, esRopa) { /* ... */ }
    function renderWishlist() { /* ... */ }
    function renderCarrito() { /* ... */ }

    // Inicialización
    renderCatalogo(productosRopa, 'catalogo-ropa', true);
    renderCatalogo(productosAccesorios, 'catalogo-accesorios', false);
    renderWishlist();

    // Función para cerrar flyer
    document.getElementById('flyer-close')?.addEventListener('click', function () {
      document.getElementById('flyer-overlay').style.display = 'none';
    });
  </script>
</body>
</html>
