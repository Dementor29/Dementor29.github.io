<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CATÁLOGO</title>
<style>
/* (Estilos existentes sin cambios, omitidos por brevedad) */
</style>
</head>
<body>
<header>
  <h1>CATÁLOGO</h1>
  <p align="center">BLACK METAL</p>
</header>

<div class="catalogo" id="catalogo-container"></div>

<div id="wishlist">
  <h3>Lista de deseos</h3>
  <ul id="wishlist-items"></ul>
</div>

<div id="cart">
  <h3>Carrito de compras</h3>
  <ul id="cart-items"></ul>
  <button class="cart-button" onclick="comprarPorWhatsapp()">Comprar</button>
  <button class="cart-button" onclick="vaciarCarrito()">Vaciar carrito</button>
</div>

<div class="volver-container">
  <a href="PAGINA.html" class="back-link">↑ VOLVER ↑</a>
</div>

<footer class="footer">
  <p style="text-align:center">© DERECHOS DE AUTOR - AVERNO - 08/06/2025</p>
</footer>

<a href="https://wa.me/573001112233?text=Hola,%20quiero%20hacer%20un%20pago%20por%20Nequi" class="nequi-btn" target="_blank" title="Pagar con Nequi">
  WHATSAPP
</a>

<script>
const productos = [
  {
    nombre: "DARKTHRONE",
    precio: 25000,
    imagen: "https://i.ibb.co/hxsDYhLw/496941007-653499041000136-3418095848827089151-n.jpg",
    whatsapp: "https://wa.me/573154277973?text=Estoy%20interesado%20en%20el%20CD%20de%20DARKTHRONE"
  },
  {
    nombre: "MORBID MACABRE",
    precio: 30000,
    imagen: "https://i.ibb.co/mVR8MwP6/495292472-657190110631029-1117194222187131368-n.jpg",
    whatsapp: "https://wa.me/573154277973?text=Estoy%20interesado%20en%20el%20CD%20de%20MORBID MACABRE"
  },
  {
    nombre: "MASACRE",
    precio: 28000,
    imagen: "https://i.ibb.co/ynMtnmZP/503859078-657190037297703-3880320405636335216-n.jpg",
    whatsapp: "https://wa.me/573154277973?text=Estoy%20interesado%20en%20el%20CD%20de%20MASACRE"
  }
];

let carrito = {};
let deseos = {};

function crearItem(producto) {
  const item = document.createElement("div");
  item.className = "item";
  item.innerHTML = `
    <span class="heart-icon" onclick="toggleFavorite(this, '${producto.nombre}', ${producto.precio})">⛧</span>
    <img src="${producto.imagen}" alt="${producto.nombre}">
    <h3>${producto.nombre}</h3>
    <div class="precio">$${producto.precio.toLocaleString()}</div>
    <input type="number" min="1" value="1" style="width: 50px; text-align: center;" onchange="actualizarCantidad('${producto.nombre}', this.value)">
    <button class="cart-button" onclick="addToCart(this, '${producto.nombre}', ${producto.precio})">Agregar al carrito</button>
  `;
  return item;
}

function renderCatalogo() {
  const container = document.getElementById("catalogo-container");
  productos.forEach(producto => {
    const item = crearItem(producto);
    container.appendChild(item);
  });
}

function toggleFavorite(element, nombre, precio) {
  if (deseos[nombre]) {
    delete deseos[nombre];
    element.classList.remove("active");
  } else {
    deseos[nombre] = { precio, cantidad: 1 };
    element.classList.add("active");
  }
  renderWishlist();
}

function actualizarCantidad(nombre, cantidad) {
  cantidad = parseInt(cantidad);
  if (carrito[nombre]) carrito[nombre].cantidad = cantidad;
  if (deseos[nombre]) deseos[nombre].cantidad = cantidad;
  renderCart();
  renderWishlist();
}

function addToCart(button, nombre, precio) {
  const cantidadInput = button.previousElementSibling;
  const cantidad = parseInt(cantidadInput.value);

  if (!carrito[nombre]) {
    carrito[nombre] = { precio, cantidad };
    renderCart();
  } else {
    alert("Este producto ya está en el carrito. Puedes cambiar la cantidad desde el selector.");
  }
}

function renderCart() {
  const cartList = document.getElementById("cart-items");
  cartList.innerHTML = "";
  for (const nombre in carrito) {
    const item = carrito[nombre];
    const li = document.createElement("li");
    li.textContent = `${nombre} - $${item.precio.toLocaleString()} x ${item.cantidad}`;
    const removeBtn = document.createElement("button");
    removeBtn.textContent = "✖";
    removeBtn.className = "remove-button";
    removeBtn.onclick = () => {
      delete carrito[nombre];
      if (!deseos[nombre]) quitarCorazon(nombre);
      renderCart();
    };
    li.appendChild(removeBtn);
    cartList.appendChild(li);
  }
}

function quitarCorazon(nombre) {
  const corazones = document.querySelectorAll(".heart-icon");
  corazones.forEach(corazon => {
    if (corazon.nextElementSibling.nextElementSibling.textContent === nombre) {
      corazon.classList.remove("active");
    }
  });
}

function renderWishlist() {
  const wishlist = document.getElementById("wishlist-items");
  wishlist.innerHTML = "";
  for (const nombre in deseos) {
    const item = deseos[nombre];
    const li = document.createElement("li");
    li.textContent = `${nombre} - $${item.precio.toLocaleString()} x ${item.cantidad}`;
    const removeBtn = document.createElement("button");
    removeBtn.textContent = "✖";
    removeBtn.className = "remove-button";
    removeBtn.onclick = () => {
      delete deseos[nombre];
      if (!carrito[nombre]) quitarCorazon(nombre);
      renderWishlist();
    };
    li.appendChild(removeBtn);
    wishlist.appendChild(li);
  }
}

function vaciarCarrito() {
  for (const nombre in carrito) {
    if (!deseos[nombre]) quitarCorazon(nombre);
  }
  carrito = {};
  renderCart();
}

function comprarPorWhatsapp() {
  if (Object.keys(carrito).length === 0) {
    alert("El carrito está vacío.");
    return;
  }
  let mensaje = "Hola, quiero comprar los siguientes ítems:%0A";
  for (const nombre in carrito) {
    const item = carrito[nombre];
    mensaje += `- ${nombre} x ${item.cantidad} - $${item.precio.toLocaleString()} c/u%0A`;
  }
  const url = `https://wa.me/573001112233?text=${mensaje}`;
  window.open(url, '_blank');
}

renderCatalogo();
</script>
</body>
</html>
